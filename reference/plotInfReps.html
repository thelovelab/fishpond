<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot inferential replicates for a gene or transcript — plotInfReps • fishpond</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot inferential replicates for a gene or transcript — plotInfReps"><meta property="og:description" content="For datasets with inferential replicates, boxplots are
drawn for the two groups and potentially grouped by
covariates. For datasets with only mean and variance,
points and intervals (95
approximation) are drawn. Additionally, for numeric
x values, points and intervals will be drawn
and computeInfRV should be run first
in order to add the mean and variance statistics."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fishpond</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.21</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/swish.html">Swish: differential expression accounting for inferential uncertainty</a>
    </li>
    <li>
      <a href="../articles/allelic.html">Allelic expression analysis with Salmon and Swish</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mikelove/fishpond/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot inferential replicates for a gene or transcript</h1>
    <small class="dont-index">Source: <a href="https://github.com/mikelove/fishpond/blob/HEAD/R/plots.R" class="external-link"><code>R/plots.R</code></a></small>
    <div class="hidden name"><code>plotInfReps.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For datasets with inferential replicates, boxplots are
drawn for the two groups and potentially grouped by
covariates. For datasets with only mean and variance,
points and intervals (95<!-- % intervals using Normal -->
approximation) are drawn. Additionally, for numeric
<code>x</code> values, points and intervals will be drawn
and <code><a href="computeInfRV.html">computeInfRV</a></code> should be run first
in order to add the mean and variance statistics.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plotInfReps</span><span class="op">(</span>
  <span class="va">y</span>,
  <span class="va">idx</span>,
  <span class="va">x</span>,
  cov <span class="op">=</span> <span class="cn">NULL</span>,
  colsDrk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dodgerblue"</span>, <span class="st">"goldenrod4"</span>, <span class="st">"royalblue4"</span>, <span class="st">"red3"</span>, <span class="st">"purple4"</span>, <span class="st">"darkgreen"</span><span class="op">)</span>,
  colsLgt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lightblue1"</span>, <span class="st">"goldenrod1"</span>, <span class="st">"royalblue1"</span>, <span class="st">"salmon1"</span>, <span class="st">"orchid1"</span>,
    <span class="st">"limegreen"</span><span class="op">)</span>,
  <span class="va">xaxis</span>,
  <span class="va">xlab</span>,
  <span class="va">ylim</span>,
  <span class="va">main</span>,
  <span class="va">mainCol</span>,
  legend <span class="op">=</span> <span class="cn">FALSE</span>,
  legendPos <span class="op">=</span> <span class="st">"topleft"</span>,
  legendTitle <span class="op">=</span> <span class="cn">FALSE</span>,
  legendCex <span class="op">=</span> <span class="fl">1</span>,
  useMean <span class="op">=</span> <span class="cn">TRUE</span>,
  q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">0.975</span><span class="op">)</span>,
  applySF <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">reorder</span>,
  <span class="va">thin</span>,
  <span class="va">shiftX</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>y</dt>
<dd><p>a SummarizedExperiment (see <code>swish</code>)</p></dd>
<dt>idx</dt>
<dd><p>the name or row number of the gene or transcript</p></dd>
<dt>x</dt>
<dd><p>the name of the condition variable for splitting
and coloring the samples or cells. Also can be a numeric,
e.g. pseudotime, in which case, <code>cov</code> can be used
to designate groups for coloring</p></dd>
<dt>cov</dt>
<dd><p>the name of the covariate for adjustment</p></dd>
<dt>colsDrk</dt>
<dd><p>dark colors for the lines of the boxes</p></dd>
<dt>colsLgt</dt>
<dd><p>light colors for the inside of the boxes</p></dd>
<dt>xaxis</dt>
<dd><p>logical, whether to label the sample numbers.
default is <code>TRUE</code> if there are less than 30 samples</p></dd>
<dt>xlab</dt>
<dd><p>the x-axis label</p></dd>
<dt>ylim</dt>
<dd><p>y limits</p></dd>
<dt>main</dt>
<dd><p>title</p></dd>
<dt>mainCol</dt>
<dd><p>name of metadata column to use for title
(instead of rowname)</p></dd>
<dt>legend</dt>
<dd><p>logical, show simple legend (default FALSE)</p></dd>
<dt>legendPos</dt>
<dd><p>character, position of the legend (default "topleft")</p></dd>
<dt>legendTitle</dt>
<dd><p>logical, whether to add the name of the
grouping variable as a title on the legend (default FALSE)</p></dd>
<dt>legendCex</dt>
<dd><p>numeric, size of the legend (default 1)</p></dd>
<dt>useMean</dt>
<dd><p>logical, when inferential replicates
are not present or when <code>x</code> is continuous,
whether to use the <code>mean</code> assay or the
<code>counts</code> assay for plotting</p></dd>
<dt>q</dt>
<dd><p>numeric, the quantile to use when plotting
the intervals when inferential replicates are not
present or when <code>x</code> is continuous. Default
is <code>qnorm(.975) ~= 1.96</code> corresponding to 95<!-- % -->
intervals</p></dd>
<dt>applySF</dt>
<dd><p>logical, when inferential replicates are
not present, should <code>y$sizeFactor</code> be divided out
from the mean and interval plots (default FALSE)</p></dd>
<dt>reorder</dt>
<dd><p>logical, should points within a group
defined by condition and covariate be re-ordered by
their count value (default is FALSE, except for alevin data)</p></dd>
<dt>thin</dt>
<dd><p>integer, should the mean and interval lines
be drawn thin (the default switches from 0 [not thin]
to 1 [thinner] at n=150 cells, and from 1 [thinner]
to 2 [thinnest] at n=400 cells)</p></dd>
<dt>shiftX</dt>
<dd><p>when <code>x</code> is continuous and <code>cov</code>
is provided, the amount to shift the values on the x-axis
to improve visibility of the point and line ranges
(will be subtracted from the first level of <code>cov</code>
and added to the second level of <code>cov</code>)</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>nothing, a plot is displayed</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="makeSimSwishData.html">makeSimSwishData</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">plotInfReps</span><span class="op">(</span><span class="va">y</span>, <span class="fl">3</span>, <span class="st">"condition"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotInfReps-1.png" alt="" width="528" height="326"></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="makeSimSwishData.html">makeSimSwishData</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">40</span><span class="op">)</span></span>
<span class="r-in"><span class="va">y</span><span class="op">$</span><span class="va">batch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">plotInfReps</span><span class="op">(</span><span class="va">y</span>, <span class="fl">3</span>, <span class="st">"condition"</span>, <span class="st">"batch"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="plotInfReps-2.png" alt="" width="528" height="326"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by <a href="https://www.linkedin.com/in/aqzhu91" class="external-link">Anqi Zhu</a>, <a href="https://mikelove.github.io" class="external-link">Michael Love</a>, <a href="https://k3yavi.github.io" class="external-link">Avi Srivastava</a>, <a href="https://combine-lab.github.io" class="external-link">Rob Patro</a>, <a href="https://sph.unc.edu/adv_profile/joseph-g-ibrahim-phd" class="external-link">Joseph Ibrahim</a>.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

